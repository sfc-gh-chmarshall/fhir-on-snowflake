definition_version: 2

entities:
  load_fhir_resource:
    type: procedure
    identifier:
      name: LOAD_FHIR_RESOURCE
      database: HL7
      schema: RAW
    stage: HL7.RAW.deployments
    handler: app.main
    runtime: "3.11"
    signature:
      - name: resource_type
        type: string
        default: "Claim"
      - name: target_table
        type: string
        default: "RAW_FHIR_RESOURCES"
      - name: event_table
        type: string
        default: "SNOWFLAKE.TELEMETRY.EVENTS"
      - name: fhir_base_url
        type: string
        default: "http://fhir-server:8080/fhir"
    returns: string
    artifacts:
      - src: load_fhir_resource/
        dest: ./
    execute_as_caller: true
